rules:
  # 1. Avoid eval()
  - id: no-eval-demo
    patterns:
      - pattern: eval($X)
    message: Avoid eval(...) — executes arbitrary code
    severity: MEDIUM
    languages: [javascript]

  # 2. Off-by-one loop (<= array.length)
  - id: off-by-one-loop
    patterns:
      - pattern: for (var $i = 0; $i <= $ARR.length; $X)
    message: Possible off-by-one error — loop runs one element past the array
    severity: HIGH
    languages: [javascript]

  # 3. Null/undefined property access (obj.prop without check)
  - id: null-access
    patterns:
      - pattern: $OBJ.$PROP
    message: Possible null/undefined access on object property
    severity: HIGH
    languages: [javascript]
    metadata:
      note: This is simplistic — real-world detection would need dataflow.

  # 4. Insecure regex (ReDoS-style)
  - id: insecure-regex
    patterns:
      - pattern-regex: '(\(.*\+.*\)\+)'   # simplistic ReDoS indicator
    message: Potential insecure regex — avoid patterns with nested quantifiers like (a+)+
    severity: CRITICAL
    languages: [javascript]
